<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>IROA - Intelligent Resource Optimization Agent</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üß†</text></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
    body { font-family: 'Inter', sans-serif; }
    .chart-container { position: relative; height: 300px; }
    .tab-content { min-height: 400px; }
    .vm-card { transition: all 0.2s ease-in-out; }
    .vm-card:hover { transform: translateY(-2px); }
  </style>
</head>
<body>
  <div id="app">
    <div class="min-h-screen bg-gray-50">
      <!-- Header -->
      <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="container mx-auto px-6 py-4">
          <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
              <div class="w-10 h-10 bg-gradient-to-br from-blue-600 to-purple-600 rounded-xl flex items-center justify-center">
                <span class="text-white font-bold text-lg">üß†</span>
              </div>
              <div>
                <h1 class="text-2xl font-bold text-gray-900">IROA</h1>
                <p class="text-sm text-gray-500">Intelligent Resource Optimization Agent</p>
              </div>
            </div>
            <div class="flex items-center space-x-4">
              <div class="flex items-center space-x-2 text-sm text-gray-600">
                <div class="w-2 h-2 bg-green-500 rounded-full"></div>
                <span>API Connected</span>
              </div>
            </div>
          </div>
        </div>
      </header>

      <!-- Navigation Tabs -->
      <nav class="bg-white border-b border-gray-200">
        <div class="container mx-auto px-6">
          <div class="flex space-x-8">
            <button 
              v-for="tab in tabs" 
              :key="tab.id"
              @click="activeTab = tab.id"
              :class="[
                'py-4 px-2 border-b-2 font-medium text-sm transition-colors duration-200',
                activeTab === tab.id 
                  ? 'border-blue-500 text-blue-600' 
                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
              ]"
            >
              <i :data-lucide="tab.icon" class="w-4 h-4 inline-block mr-2"></i>
              {{ tab.name }}
            </button>
          </div>
        </div>
      </nav>

      <!-- Main Content -->
      <main class="container mx-auto px-6 py-8">
        <!-- Overview Tab -->
        <div v-if="activeTab === 'overview'" class="tab-content">
          <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-2">Dashboard Overview</h2>
            <p class="text-gray-600">Monitor your virtualization infrastructure at a glance</p>
          </div>

          <!-- Stats Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div v-for="stat in stats" :key="stat.title" class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm font-medium text-gray-600">{{ stat.title }}</p>
                  <p class="text-2xl font-bold text-gray-900 mt-1">{{ stat.value }}</p>
                </div>
                <div :class="[stat.bgColor, 'w-12 h-12 rounded-lg flex items-center justify-center']">
                  <i :data-lucide="stat.icon" class="w-6 h-6 text-white"></i>
                </div>
              </div>
              <div v-if="stat.change !== 0" class="mt-4 flex items-center">
                <i :data-lucide="stat.change > 0 ? 'trending-up' : 'trending-down'" 
                   :class="[stat.change > 0 ? 'text-green-500' : 'text-red-500', 'w-4 h-4 mr-1']"></i>
                <span :class="[stat.change > 0 ? 'text-green-600' : 'text-red-600', 'text-sm font-medium']">
                  {{ Math.abs(stat.change) }}%
                </span>
                <span class="text-gray-500 text-sm ml-1">vs last month</span>
              </div>
            </div>
          </div>

          <!-- Charts -->
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">Resource Usage</h3>
              <div class="chart-container">
                <canvas id="usageChart"></canvas>
              </div>
            </div>
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">VM Distribution</h3>
              <div class="chart-container">
                <canvas id="distributionChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Administration Tab -->
        <div v-if="activeTab === 'admin'" class="tab-content">
          <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-2">System Administration</h2>
            <p class="text-gray-600">Manage integrations and system monitoring</p>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
            <!-- Integration Selection -->
            <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">Available Integrations</h3>
              <div class="space-y-3">
                <div 
                  v-for="option in adminData.integrationOptions" 
                  :key="option.id"
                  @click="adminData.selectedIntegration = option.id"
                  :class="[
                    'p-4 rounded-lg border-2 cursor-pointer transition-all duration-200',
                    adminData.selectedIntegration === option.id 
                      ? 'border-blue-500 bg-blue-50' 
                      : 'border-gray-200 hover:border-gray-300'
                  ]"
                >
                  <div class="flex items-center space-x-3">
                    <span class="text-2xl">{{ option.icon }}</span>
                    <div>
                      <h4 class="font-medium text-gray-900">{{ option.name }}</h4>
                      <p class="text-sm text-gray-500">{{ option.description }}</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Mac System Integration -->
            <div v-if="adminData.selectedIntegration === 'mac'" class="lg:col-span-2 bg-white rounded-xl shadow-sm p-6 border border-gray-100">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">üçé Mac System Monitoring</h3>
              
              <!-- Mac System Controls -->
              <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                  <div>
                    <h4 class="font-medium text-gray-900">System Monitoring</h4>
                    <p class="text-sm text-gray-500">
                      Status: {{ adminData.macMonitoring.isRunning ? 'Running' : 'Stopped' }}
                    </p>
                  </div>
                  <div class="flex space-x-2">
                    <button 
                      @click="startMacMonitoring"
                      :disabled="adminData.macMonitoring.isRunning"
                      class="px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      Start
                    </button>
                    <button 
                      @click="stopMacMonitoring"
                      :disabled="!adminData.macMonitoring.isRunning"
                      class="px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      Stop
                    </button>
                    <button 
                      @click="getMacStats"
                      class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                    >
                      Get Stats
                    </button>
                  </div>
                </div>

                <!-- System Info -->
                <div v-if="adminData.macMonitoring.systemInfo" class="p-4 bg-blue-50 rounded-lg">
                  <h4 class="font-medium text-gray-900 mb-2">System Information</h4>
                  <div class="grid grid-cols-2 gap-4 text-sm">
                    <div><strong>Model:</strong> {{ adminData.macMonitoring.systemInfo.model }}</div>
                    <div><strong>CPU:</strong> {{ adminData.macMonitoring.systemInfo.cpu }}</div>
                    <div><strong>Memory:</strong> {{ adminData.macMonitoring.systemInfo.memory }}</div>
                    <div><strong>Serial:</strong> {{ adminData.macMonitoring.systemInfo.serial }}</div>
                  </div>
                </div>

                <!-- Current Stats -->
                <div v-if="adminData.macMonitoring.currentStats" class="p-4 bg-green-50 rounded-lg">
                  <h4 class="font-medium text-gray-900 mb-2">Current Statistics</h4>
                  <div class="grid grid-cols-3 gap-4 text-sm">
                    <div class="text-center">
                      <div class="text-2xl font-bold text-blue-600">{{ adminData.macMonitoring.currentStats.cpu_usage }}%</div>
                      <div class="text-gray-600">CPU Usage</div>
                    </div>
                    <div class="text-center">
                      <div class="text-2xl font-bold text-green-600">{{ adminData.macMonitoring.currentStats.memory_usage }}%</div>
                      <div class="text-gray-600">Memory Usage</div>
                    </div>
                    <div class="text-center">
                      <div class="text-2xl font-bold text-purple-600">{{ adminData.macMonitoring.currentStats.disk_usage }}%</div>
                      <div class="text-gray-600">Disk Usage</div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Other Integration Forms -->
            <div v-else class="lg:col-span-2 bg-white rounded-xl shadow-sm p-6 border border-gray-100">
              <h3 class="text-lg font-semibold text-gray-900 mb-4">
                {{ adminData.integrationOptions.find(opt => opt.id === adminData.selectedIntegration)?.name }} Configuration
              </h3>
              <p class="text-gray-600 mb-6">Configure your {{ adminData.selectedIntegration }} integration settings.</p>
              
              <div class="space-y-4">
                <div v-if="adminData.selectedIntegration === 'vcenter'">
                  <label class="block text-sm font-medium text-gray-700 mb-1">vCenter Host</label>
                  <input v-model="adminData.connectionForms.vcenter.host" type="text" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
                
                <button 
                  @click="testConnection"
                  class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                >
                  Test Connection
                </button>
              </div>
            </div>
          </div>
        </div>

        <!-- Other Tabs (Simplified) -->
        <div v-if="activeTab === 'recommendations'" class="tab-content">
          <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-2">AI Recommendations</h2>
            <p class="text-gray-600">Optimize your infrastructure with AI-powered insights</p>
          </div>
          <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
            <p class="text-gray-600">Loading recommendations...</p>
          </div>
        </div>

        <div v-if="activeTab === 'vms'" class="tab-content">
          <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-2">Virtual Machines</h2>
            <p class="text-gray-600">Monitor and manage your virtual infrastructure</p>
          </div>
          <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
            <p class="text-gray-600">Loading virtual machines...</p>
          </div>
        </div>

        <div v-if="activeTab === 'analytics'" class="tab-content">
          <div class="mb-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-2">Analytics</h2>
            <p class="text-gray-600">Deep insights into your infrastructure performance</p>
          </div>
          <div class="bg-white rounded-xl shadow-sm p-6 border border-gray-100">
            <p class="text-gray-600">Loading analytics...</p>
          </div>
        </div>
      </main>
    </div>
  </div>

  <script>
    const { createApp } = Vue;

    createApp({
      data() {
        return {
          activeTab: 'overview',
          tabs: [
            { id: 'overview', name: 'Overview', icon: 'layout-dashboard' },
            { id: 'recommendations', name: 'Recommendations', icon: 'lightbulb' },
            { id: 'vms', name: 'Virtual Machines', icon: 'server' },
            { id: 'analytics', name: 'Analytics', icon: 'bar-chart-3' },
            { id: 'admin', name: 'Administration', icon: 'settings' }
          ],
          stats: [
            { title: 'Total VMs', value: '5', change: 0, icon: 'server', bgColor: 'bg-blue-500' },
            { title: 'Underutilized', value: '2', change: -20, icon: 'trending-down', bgColor: 'bg-yellow-500' },
            { title: 'Cost Savings', value: '$1,240', change: 15, icon: 'dollar-sign', bgColor: 'bg-green-500' },
            { title: 'Efficiency', value: '87%', change: 5, icon: 'zap', bgColor: 'bg-purple-500' }
          ],
          adminData: {
            selectedIntegration: 'mac',
            macMonitoring: {
              isRunning: false,
              interval: 30,
              lastUpdate: null,
              systemInfo: null,
              currentStats: null
            },
            integrationOptions: [
              { id: 'mac', name: 'Mac System', icon: 'üçé', description: 'Monitor your Mac system resources' },
              { id: 'vcenter', name: 'VMware vCenter', icon: 'üè¢', description: 'Connect to VMware vCenter Server' },
              { id: 'zabbix', name: 'Zabbix', icon: 'üìä', description: 'Integrate with Zabbix monitoring' },
              { id: 'prometheus', name: 'Prometheus', icon: 'üî•', description: 'Connect to Prometheus metrics' }
            ],
            connectionForms: {
              vcenter: { host: 'vcenter.local', username: 'administrator@vsphere.local', password: '' },
              zabbix: { url: 'http://zabbix.local/api_jsonrpc.php', username: 'Admin', password: '' },
              prometheus: { url: 'http://localhost:9090' }
            }
          }
        };
      },
      methods: {
        async startMacMonitoring() {
          try {
            const response = await fetch('http://localhost:8001/admin/mac/start', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' }
            });
            const data = await response.json();
            if (data.status === 'started') {
              this.adminData.macMonitoring.isRunning = true;
              alert('Mac monitoring started successfully!');
            }
          } catch (error) {
            alert('Failed to start Mac monitoring: ' + error.message);
          }
        },
        async stopMacMonitoring() {
          try {
            const response = await fetch('http://localhost:8001/admin/mac/stop', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' }
            });
            const data = await response.json();
            if (data.status === 'stopped') {
              this.adminData.macMonitoring.isRunning = false;
              alert('Mac monitoring stopped successfully!');
            }
          } catch (error) {
            alert('Failed to stop Mac monitoring: ' + error.message);
          }
        },
        async getMacStats() {
          try {
            const response = await fetch('http://localhost:8001/admin/mac/stats');
            const data = await response.json();
            this.adminData.macMonitoring.systemInfo = data.system_info;
            this.adminData.macMonitoring.currentStats = {
              cpu_usage: Math.round(data.cpu_usage * 10) / 10,
              memory_usage: Math.round(data.memory_usage * 10) / 10,
              disk_usage: Math.round(data.disk_usage * 10) / 10
            };
            this.adminData.macMonitoring.isRunning = data.monitoring_active;
          } catch (error) {
            alert('Failed to get Mac stats: ' + error.message);
          }
        },
        async testConnection() {
          alert('Connection test feature coming soon!');
        },
        initializeCharts() {
          // Usage Chart
          const usageCtx = document.getElementById('usageChart');
          if (usageCtx) {
            new Chart(usageCtx, {
              type: 'line',
              data: {
                labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                datasets: [{
                  label: 'CPU Usage',
                  data: [65, 59, 80, 81, 56, 55],
                  borderColor: 'rgb(59, 130, 246)',
                  backgroundColor: 'rgba(59, 130, 246, 0.1)',
                  tension: 0.4
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                  legend: {
                    display: false
                  }
                }
              }
            });
          }

          // Distribution Chart
          const distCtx = document.getElementById('distributionChart');
          if (distCtx) {
            new Chart(distCtx, {
              type: 'doughnut',
              data: {
                labels: ['Production', 'Development', 'Testing'],
                datasets: [{
                  data: [60, 25, 15],
                  backgroundColor: [
                    'rgb(59, 130, 246)',
                    'rgb(16, 185, 129)',
                    'rgb(245, 158, 11)'
                  ]
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false
              }
            });
          }
        }
      },
      mounted() {
        // Initialize Lucide icons
        if (typeof lucide !== 'undefined') {
          lucide.createIcons();
        }
        
        // Initialize charts after a short delay
        this.$nextTick(() => {
          setTimeout(() => {
            this.initializeCharts();
          }, 100);
        });

        // Get initial Mac stats
        this.getMacStats();
      }
    }).mount('#app');
  </script>
</body>
</html>
